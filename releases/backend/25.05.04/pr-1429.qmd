---
title: "Add ability to export comments in validation reports (#1429)"
categories: [backend, 25.05.04, hotfix, enhancement]
sidebar: release-notes
toc-expand: true
date: "May 16, 2025"
# Content edited by AI - 2025-06-04 18:01
# Content validated by AI - 2025-06-04 18:01
# Content overwritten from an earlier version - 2025-06-04 18:01
# PR URL: https://github.com/validmind/backend/pull/1429
---

We have added the ability to export comments from validation reports. Previously, only flags could be exported, and exporting comments was not possible. By default, exporting comments is turned off.

With the corresponding frontend update, there is now a checkbox labeled "Include comments left on document" available when exporting the validation report.

This change was made in response to customer requests for the option to save contributor comments.

This update enhances reporting by integrating user comments into generated reports. Key changes include:

- A new static method `get_user_comments_by_model_id` in `annotation.py` queries and joins annotation data with related comments and their creators.
  
- Report serialization in `model_inventory.py` and `reports.py` now supports an `include_comments` flag to embed user comments, affecting document generation and structure.

- `ui_reporting.py` routes parse a new parameter for comment inclusion, with `parse_generate_report_params` consolidating all report parameters, including `include_comments`.

- A new function `get_comment_text_for_doc` in report render helpers processes comments, strips HTML, and organizes them into styled text blocks for document fragments.

- The `ExportAnnotation` dataclass in `util_models.py` facilitates clean export of comment details, including user name, text, creation date, and context.

- Unit tests in `test_reports.py` verify serialization with comments, ensure comments appear correctly in document fragments, and validate HTML cleaning before embedding in reports.

These changes ensure user comments are properly queried, formatted, and integrated into reports for a comprehensive output.