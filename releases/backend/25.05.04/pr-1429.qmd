---
title: "Add ability to export comments in validation reports (#1429)"
categories: [backend, 25.05.04, hotfix, enhancement, python]
sidebar: release-notes
toc-expand: true
date: "May 16, 2025"
# Content edited by AI - 2025-06-04 12:29
# Content validated by AI - 2025-06-04 12:29
# Content overwritten from an earlier version - 2025-06-04 12:29
# PR URL: https://github.com/validmind/backend/pull/1429
---

We have added the ability to export comments from validation reports. Previously, only flags could be exported, excluding comments. Now, you can choose to include comments when exporting a validation report. This feature is controlled by a checkbox labeled "Include comments left on document," which is unchecked by default. This update addresses customer requests for saving contributor comments.

This update enhances reporting by integrating user comments into generated reports. Key changes include:

- A new static method `get_user_comments_by_model_id` in `annotation.py` queries and joins annotation data with related comments and their creators.
  
- The report serialization in `model_inventory.py` and `reports.py` now supports an `include_comments` flag to embed user comments, affecting document generation and structure.

- `ui_reporting.py` updates UI reporting routes to parse a new parameter for comments inclusion. The helper method `parse_generate_report_params` consolidates all report parameters, including `include_comments`.

- A new function `get_comment_text_for_doc` in report render helpers processes comments, strips HTML, and organizes them into styled text blocks for document fragments.

- A new dataclass `ExportAnnotation` in `util_models.py` facilitates clean export of comment details, including user name, text content, created date, and context.

- Unit tests in `test_reports.py` verify functionality: testing serialization with comments, ensuring comments appear correctly in document fragments, and validating HTML cleaning before embedding in reports.

These changes ensure user comments are properly queried, formatted, and integrated into reports for comprehensive output.