---
title: "[SC-7548] trigger workflow when a model attribute changes"
categories: [backend, 25.05.04, hotfix]
sidebar: release-notes
toc-expand: true
date: "May 23, 2025"
# PR URL: https://github.com/validmind/backend/pull/1405
---
# PR Summary

This PR introduces several non-trivial enhancements to the workflow trigger mechanism and inventory model field update handling. The key changes include:

1. Increased the celery worker concurrency from 5 to 6 in the Makefile, which may improve parallel task processing.

2. Added a new migration to introduce the optional column "trigger_field_key" in the workflows table. This field supports triggering workflows based on specific field changes in inventory models.

3. Updated the InventoryModel update method to return both the updated field information and the old value, allowing further processing by triggering background tasks.

4. Expanded the Workflow model:
   - Now supports an additional trigger type and extended its allowed entities and events with a new "InventoryModel.field" type and an "updated" event type.
   - New helper properties (is_deleted and is_enabled) were added for easier status checking.
   - The workflow serialization method now includes the new trigger_field_key.

5. The workflow validation methods have been enhanced to validate the trigger_field_key along with type, entity name, and event type. The validation errors now use a custom BadRequestError with more descriptive error messages.

6. The API endpoints in the UI routes for workflows and inventory models have been updated to pass and process the trigger_field_key. In particular, when a model field changes, a new celery task (on_model_field_change) is triggered to process workflow executions.

7. The WorkflowManager's start_execution method now includes type hints and improved documentation. Minor adjustments in test files ensure that date comparisons use timezone-aware datetime objects.

Overall, these changes improve the robustness and clarity of the workflow triggering mechanism with extended support for specific field updates in inventory models and refined error handling.